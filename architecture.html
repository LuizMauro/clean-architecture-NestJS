<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Clean Architecture NestJS - Documenta√ß√£o Detalhada</title>
    <style>
      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        line-height: 1.6;
        color: #333;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f5f5f5;
      }

      h1,
      h2,
      h3 {
        color: #2c3e50;
      }

      .layer {
        border: 1px solid #ddd;
        padding: 20px;
        margin: 20px 0;
        border-radius: 5px;
        background-color: white;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .layer-title {
        background: #f8f9fa;
        padding: 15px;
        margin: -20px -20px 20px -20px;
        border-bottom: 1px solid #ddd;
        border-radius: 5px 5px 0 0;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .folder {
        margin-left: 20px;
        padding: 15px;
        border-left: 3px solid #3498db;
        background-color: #f8f9fa;
        margin-bottom: 15px;
      }

      .code-block {
        background: #282c34;
        color: #abb2bf;
        padding: 15px;
        border-radius: 5px;
        overflow-x: auto;
        font-family: 'Fira Code', monospace;
        margin: 10px 0;
      }

      .example {
        background: #fff8dc;
        padding: 15px;
        margin: 10px 0;
        border-left: 4px solid #ffd700;
        border-radius: 0 5px 5px 0;
      }

      .flow {
        background: #f8f9fa;
        padding: 20px;
        margin: 20px 0;
        border-radius: 5px;
        border: 1px solid #e9ecef;
      }

      .tag {
        background: #3498db;
        color: white;
        padding: 3px 8px;
        border-radius: 3px;
        font-size: 0.8em;
      }

      .note {
        background: #e1f5fe;
        padding: 15px;
        margin: 10px 0;
        border-left: 4px solid #03a9f4;
        border-radius: 0 5px 5px 0;
      }

      .implementation {
        margin-top: 15px;
        padding: 15px;
        background: #f1f8ff;
        border-radius: 5px;
      }

      .diagram {
        background: white;
        padding: 20px;
        margin: 20px 0;
        border-radius: 5px;
        border: 1px solid #ddd;
      }

      .code-title {
        background: #21252b;
        color: #fff;
        padding: 5px 15px;
        border-radius: 5px 5px 0 0;
        margin-bottom: -10px;
      }

      .section-nav {
        position: fixed;
        top: 20px;
        right: 20px;
        background: white;
        padding: 15px;
        border-radius: 5px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        max-width: 250px;
      }

      .section-nav ul {
        list-style: none;
        padding: 0;
      }

      .section-nav li {
        margin: 5px 0;
      }

      .section-nav a {
        color: #3498db;
        text-decoration: none;
      }

      .code-explanation {
        background: #f1f8ff;
        padding: 15px;
        margin: 10px 0;
        border-radius: 5px;
      }

      .warning {
        background: #fff3cd;
        border-left: 4px solid #ffc107;
        padding: 15px;
        margin: 10px 0;
        border-radius: 0 5px 5px 0;
      }

      .best-practice {
        background: #d4edda;
        border-left: 4px solid #28a745;
        padding: 15px;
        margin: 10px 0;
        border-radius: 0 5px 5px 0;
      }

      .pattern-example {
        background: #e8eaf6;
        border-left: 4px solid #3f51b5;
        padding: 15px;
        margin: 10px 0;
        border-radius: 0 5px 5px 0;
      }
    </style>
  </head>
  <body>
    <!-- Menu de Navega√ß√£o -->
    <nav class="section-nav">
      <h3>√çndice</h3>
      <ul>
        <li>
          <a href="#visao-geral">Vis√£o Geral</a>
        </li>
        <li>
          <a href="#arquitetura">Arquitetura</a>
        </li>
        <li>
          <a href="#camadas">Camadas</a>
        </li>
        <li>
          <a href="#injecao-dependencia">Inje√ß√£o de Depend√™ncia</a>
        </li>
        <li>
          <a href="#tratamento-erros">Tratamento de Erros</a>
        </li>
        <li>
            <a href="#padroes-projeto"> Padr√µes de Projeto e Boas Pr√°ticas</a>
        </li>
        <li>
            <a href="#documentacao">Documenta√ß√£o com Swagger</a>
        </li>
        <li>
            <a href="#conclusao">Conclus√£o e Boas Pr√°ticas</a>
        </li>
      </ul>
    </nav>
    <h1>üèóÔ∏è Clean Architecture com NestJS - Documenta√ß√£o Detalhada</h1>


    <!-- Se√ß√£o: Vis√£o Geral -->
    <section id="visao-geral" class="layer">
      <div class="layer-title">
        <h2>Vis√£o Geral da Arquitetura</h2>
      </div>
      <div class="note">
        <h3>Objetivos</h3>
        <ul>
          <li>Separa√ß√£o clara de responsabilidades</li>
          <li>Independ√™ncia de frameworks</li>
          <li>Testabilidade</li>
          <li>Manutenibilidade</li>
          <li>Escalabilidade</li>
        </ul>
      </div>
      <div class="diagram">
        <h3>Estrutura de Camadas</h3>
        <pre>
Presentation Layer (Controllers)
           ‚Üì
Application Layer (Use Cases)
           ‚Üì
Domain Layer (Entities)
           ‚Üì
Infrastructure Layer (Repositories)
            </pre>
      </div>
      <div class="best-practice">
        <h3>Regras de Depend√™ncia</h3>
        <ul>
          <li>Camadas externas podem depender de camadas internas</li>
          <li>Camadas internas n√£o conhecem camadas externas</li>
          <li>Depend√™ncias sempre apontam para dentro</li>
        </ul>
      </div>
    </section>

    <!-- Se√ß√£o: Arquitetura -->
<section id="arquitetura" class="layer">
    <div class="layer-title">
        <h2>Arquitetura do Projeto</h2>
    </div>

    <div class="folder">
        <h3>Estrutura de Diret√≥rios</h3>
        <div class="code-block">
            <pre>
src/
‚îú‚îÄ‚îÄ core/                     # Regras de neg√≥cio e entidades
‚îÇ   ‚îú‚îÄ‚îÄ entities/            # Entidades do dom√≠nio
‚îÇ   ‚îú‚îÄ‚îÄ interfaces/          # Contratos e interfaces
‚îÇ   ‚îî‚îÄ‚îÄ errors/             # Erros espec√≠ficos do dom√≠nio
‚îÇ
‚îú‚îÄ‚îÄ application/             # Casos de uso e l√≥gica de aplica√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ use-cases/          # Implementa√ß√£o dos casos de uso
‚îÇ   ‚îî‚îÄ‚îÄ dtos/               # Objetos de transfer√™ncia de dados
‚îÇ
‚îú‚îÄ‚îÄ infrastructure/          # Implementa√ß√µes t√©cnicas
‚îÇ   ‚îú‚îÄ‚îÄ database/           # Configura√ß√µes e entidades do banco
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entities/       # Entidades do TypeORM
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ mappers/       # Conversores de entidades
‚îÇ   ‚îú‚îÄ‚îÄ repositories/       # Implementa√ß√µes dos reposit√≥rios
‚îÇ   ‚îî‚îÄ‚îÄ common/            # Utilit√°rios compartilhados
‚îÇ       ‚îú‚îÄ‚îÄ filters/       # Filtros de exce√ß√£o
‚îÇ       ‚îú‚îÄ‚îÄ interceptors/  # Interceptadores
‚îÇ       ‚îî‚îÄ‚îÄ middleware/    # Middlewares
‚îÇ
‚îî‚îÄ‚îÄ presentation/           # Interface com o usu√°rio
    ‚îî‚îÄ‚îÄ controllers/       # Controllers da API REST
            </pre>
        </div>
    </div>

    <div class="folder">
        <h3>Fluxo de Dados</h3>
        <div class="diagram">
            <pre>
Cliente HTTP ‚Üí Controller ‚Üí Use Case ‚Üí Repository Interface ‚Üí Repository Implementation ‚Üí Banco de Dados
     ‚Üë           ‚Üë            ‚Üë              ‚Üë                    ‚Üë                         ‚Üë
  Response ‚Üê ResponseDTO ‚Üê Domain Entity ‚Üê Interface ‚Üê Repository Implementation ‚Üê Database Entity
            </pre>
        </div>
        <div class="code-explanation">
            <h4>Processo:</h4>
            <ol>
                <li>Cliente faz requisi√ß√£o HTTP para um endpoint</li>
                <li>Controller recebe e valida os dados (DTO)</li>
                <li>Use Case executa a l√≥gica de neg√≥cio</li>
                <li>Repository Interface define o contrato</li>
                <li>Repository Implementation interage com o banco</li>
                <li>Dados retornam pelo mesmo caminho</li>
            </ol>
        </div>
    </div>

    <div class="folder">
        <h3>Depend√™ncias entre Camadas</h3>
        <div class="implementation">
            <div class="code-explanation">
                <h4>Regras:</h4>
                <ul>
                    <li>üéØ Core n√£o depende de nenhuma outra camada</li>
                    <li>üîÑ Application depende apenas do Core</li>
                    <li>üõ†Ô∏è Infrastructure implementa interfaces do Core</li>
                    <li>üñ•Ô∏è Presentation depende de Application</li>
                </ul>
            </div>
        </div>
        <div class="note">
            <h4>Benef√≠cios:</h4>
            <ul>
                <li>‚úÖ Baixo acoplamento entre camadas</li>
                <li>‚úÖ Facilidade para trocar implementa√ß√µes</li>
                <li>‚úÖ Regras de neg√≥cio protegidas</li>
                <li>‚úÖ Melhor testabilidade</li>
            </ul>
        </div>
    </div>

    <div class="folder">
        <h3>Componentes Principais</h3>
        <div class="implementation">
            <ul>
                <li>
                    <strong>Entidades:</strong> Regras de neg√≥cio e valida√ß√µes
                    <div class="example">User, Product, Order, etc.</div>
                </li>
                <li>
                    <strong>Use Cases:</strong> L√≥gica de aplica√ß√£o
                    <div class="example">CreateUser, UpdateUser, DeleteUser, etc.</div>
                </li>
                <li>
                    <strong>Repositories:</strong> Persist√™ncia de dados
                    <div class="example">UserRepository, ProductRepository, etc.</div>
                </li>
                <li>
                    <strong>Controllers:</strong> Endpoints da API
                    <div class="example">UserController, ProductController, etc.</div>
                </li>
            </ul>
        </div>
    </div>

    <div class="warning">
        <h4>Pontos de Aten√ß√£o na Arquitetura:</h4>
        <ul>
            <li>‚ö†Ô∏è Manter a dire√ß√£o das depend√™ncias</li>
            <li>‚ö†Ô∏è N√£o vazar detalhes de implementa√ß√£o</li>
            <li>‚ö†Ô∏è Usar interfaces para acoplamento fraco</li>
            <li>‚ö†Ô∏è Manter entidades do dom√≠nio puras</li>
            <li>‚ö†Ô∏è Separar responsabilidades claramente</li>
        </ul>
    </div>
</section>


    <!-- Se√ß√£o: Detalhamento das Camadas -->
    <section id="camadas" class="layer">
      <div class="layer-title">
        <h2>Detalhamento das Camadas</h2>
      </div>
      <!-- Core/Domain Layer -->
      <div class="folder">
        <h3>1. Core/Domain Layer</h3>
        <div class="note">
          <p>Camada mais interna, cont√©m as regras de neg√≥cio e entidades do dom√≠nio.</p>
        </div>
        <div class="implementation">
          <div class="code-title">Entidade de Dom√≠nio (User)</div>
          <div class="code-block">
            <pre>
export class User {
    constructor(
        private readonly id: string,
        private readonly name: string,
        private readonly email: string,
        private readonly password: string,
    ) {}

    getId(): string { return this.id; }
    getName(): string { return this.name; }
    getEmail(): string { return this.email; }
    getPassword(): string { return this.password; }

    isValidPassword(password: string): boolean {
        return password.length >= 6;
    }
}
                </pre>
          </div>
          <div class="code-explanation">
            <ul>
              <li>‚úÖ Encapsulamento atrav√©s de getters</li>
              <li>‚úÖ Imutabilidade com readonly</li>
              <li>‚úÖ Regras de neg√≥cio (valida√ß√£o de senha)</li>
              <li>‚úÖ Independente de frameworks</li>
            </ul>
          </div>
        </div>
        <div class="implementation">
          <div class="code-title">Interface do Reposit√≥rio</div>
          <div class="code-block">
            <pre>
export interface IUserRepository {
    create(user: User): Promise
					<User>;
    findById(id: string): Promise
						<User>;
    findByEmail(email: string): Promise
							<User>;
    findAll(): Promise<User[]>;
    update(id: string, user: User): Promise
								<User>;
    delete(id: string): Promise
									<void>;
}
                
									</pre>
          </div>
          <div class="code-explanation">
            <ul>
              <li>‚úÖ Define contrato para persist√™ncia</li>
              <li>‚úÖ Independente de implementa√ß√£o</li>
              <li>‚úÖ Permite m√∫ltiplas implementa√ß√µes</li>
            </ul>
          </div>
        </div>
      </div>
      <!-- Application Layer -->
      <div class="folder">
        <h3>2. Application Layer</h3>
        <div class="note">
          <p>Orquestra o fluxo de dados e implementa casos de uso da aplica√ß√£o.</p>
        </div>
        <div class="implementation">
          <div class="code-title">Caso de Uso (CreateUser)</div>
          <div class="code-block">
            <pre>
@Injectable()
export class CreateUserUseCase {
    constructor(
        @Inject('IUserRepository')
        private readonly userRepository: IUserRepository
    ) {}

    async execute(createUserDto: CreateUserDto): Promise
										<User> {
        const existingUser = await this.userRepository
            .findByEmail(createUserDto.email);
        
        if (existingUser) {
            throw new EmailAlreadyExistsError(createUserDto.email);
        }

        const user = new User(
            uuidv4(),
            createUserDto.name,
            createUserDto.email,
            createUserDto.password
        );

        if (!user.isValidPassword(createUserDto.password)) {
            throw new InvalidPasswordError();
        }

        return this.userRepository.create(user);
    }
}
                
										</pre>
          </div>
          <div class="code-explanation">
            <ul>
              <li>‚úÖ Implementa l√≥gica de neg√≥cio espec√≠fica</li>
              <li>‚úÖ Usa inje√ß√£o de depend√™ncia</li>
              <li>‚úÖ Trata erros do dom√≠nio</li>
              <li>‚úÖ Valida regras de neg√≥cio</li>
            </ul>
          </div>
        </div>
        <div class="implementation">
          <div class="code-title">DTOs (Data Transfer Objects)</div>
          <div class="code-block">
            <pre>
export class CreateUserDto {
    @ApiProperty()
    @IsString()
    @IsNotEmpty()
    @MinLength(3)
    name: string;

    @ApiProperty()
    @IsEmail()
    @IsNotEmpty()
    email: string;

    @ApiProperty()
    @IsString()
    @MinLength(6)
    password: string;
}
                </pre>
          </div>
          <div class="code-explanation">
            <ul>
              <li>‚úÖ Valida√ß√£o de dados de entrada</li>
              <li>‚úÖ Documenta√ß√£o com Swagger</li>
              <li>‚úÖ Tipagem forte</li>
            </ul>
          </div>
        </div>
      </div>
      <!-- Infrastructure Layer -->
      <div class="folder">
        <h3>3. Infrastructure Layer</h3>
        <div class="note">
          <p>Implementa detalhes t√©cnicos e integra√ß√µes com servi√ßos externos.</p>
        </div>
        <div class="implementation">
          <div class="code-title">Implementa√ß√£o do Reposit√≥rio</div>
          <div class="code-block">
            <pre>
@Injectable()
export class UserRepository implements IUserRepository {
    constructor(
        @InjectRepository(UserTypeormEntity)
        private readonly userRepository: Repository
											<UserTypeormEntity>
    ) {}

    async create(user: User): Promise
												<User> {
        const persistenceUser = UserMapper.toPersistence(user);
        const savedUser = await this.userRepository.save(persistenceUser);
        return UserMapper.toDomain(savedUser);
    }
    // ... outros m√©todos
}
                
												</pre>
          </div>
          <div class="code-explanation">
            <ul>
              <li>‚úÖ Implementa interface do dom√≠nio</li>
              <li>‚úÖ Usa TypeORM para persist√™ncia</li>
              <li>‚úÖ Mapeia entre dom√≠nio e ORM</li>
            </ul>
          </div>
        </div>
      </div>
    </section>


    <!-- Se√ß√£o: Inje√ß√£o de Depend√™ncia -->
    <section id="injecao-dependencia" class="layer">
      <div class="layer-title">
        <h2>Inje√ß√£o de Depend√™ncia e Invers√£o de Controle</h2>
      </div>
      <div class="note">
        <p>O NestJS utiliza um sistema de inje√ß√£o de depend√™ncia poderoso que nos permite implementar a invers√£o de controle de forma elegante.</p>
      </div>
      <div class="folder">
        <h3>1. Fluxo de Inje√ß√£o</h3>
        <div class="implementation">
          <div class="code-title">1.1 Defini√ß√£o da Interface (Core)</div>
          <div class="code-block">
            <pre>
// src/core/interfaces/repositories/user-repository.interface.ts
export interface IUserRepository {
    create(user: User): Promise
													<User>;
    findById(id: string): Promise
														<User>;
    // ... outros m√©todos
}
                
														</pre>
          </div>
          <div class="code-title">1.2 Registro do Provider (Infrastructure)</div>
          <div class="code-block">
            <pre>
// src/infrastructure/infrastructure.module.ts
@Module({
    imports: [
        TypeOrmModule.forRoot(databaseConfig),
        TypeOrmModule.forFeature([UserTypeormEntity])
    ],
    providers: [{
        provide: 'IUserRepository',
        useClass: UserRepository
    }],
    exports: ['IUserRepository']
})
export class InfrastructureModule {}
                </pre>
          </div>
          <div class="code-title">1.3 Inje√ß√£o no Caso de Uso (Application)</div>
          <div class="code-block">
            <pre>
// src/application/use-cases/create-user.use-case.ts
@Injectable()
export class CreateUserUseCase {
    constructor(
        @Inject('IUserRepository')
        private readonly userRepository: IUserRepository
    ) {}
}
                </pre>
          </div>
        </div>
        <div class="code-explanation">
          <h4>Benef√≠cios:</h4>
          <ul>
            <li>‚úÖ Desacoplamento entre camadas</li>
            <li>‚úÖ Facilidade para testes (mock de depend√™ncias)</li>
            <li>‚úÖ Flexibilidade para trocar implementa√ß√µes</li>
            <li>‚úÖ C√≥digo mais limpo e organizado</li>
          </ul>
        </div>
      </div>
      <div class="folder">
        <h3>2. Troca de Implementa√ß√µes</h3>
        <div class="implementation">
          <div class="code-title">Exemplo: Mudando para MongoDB</div>
          <div class="code-block">
            <pre>
// Nova implementa√ß√£o do reposit√≥rio
@Injectable()
export class UserMongoRepository implements IUserRepository {
    constructor(
        @InjectModel(UserMongoEntity.name)
        private readonly userModel: Model
															<UserMongoEntity>
    ) {}

    async create(user: User): Promise
																<User> {
        const mongoUser = UserMongoMapper.toPersistence(user);
        const created = await this.userModel.create(mongoUser);
        return UserMongoMapper.toDomain(created);
    }
    // ... outros m√©todos
}

// Atualiza√ß√£o do m√≥dulo
@Module({
    imports: [
        MongooseModule.forRoot('mongodb://localhost/nest'),
        MongooseModule.forFeature([
            { name: UserMongoEntity.name, schema: UserSchema }
        ])
    ],
    providers: [{
        provide: 'IUserRepository',
        useClass: UserMongoRepository // üëà √önica mudan√ßa necess√°ria
    }],
    exports: ['IUserRepository']
})
export class InfrastructureModule {}
                
																</pre>
          </div>
        </div>
        <div class="warning">
          <h4>Importante:</h4>
          <p>Ao trocar implementa√ß√µes:</p>
          <ul>
            <li>‚úÖ Casos de uso permanecem inalterados</li>
            <li>‚úÖ Controllers n√£o s√£o afetados</li>
            <li>‚úÖ Entidades do dom√≠nio continuam as mesmas</li>
            <li>‚úÖ Testes continuam v√°lidos</li>
          </ul>
        </div>
      </div>
    </section>

    
    <!-- Se√ß√£o: Tratamento de Erros -->
    <section id="tratamento-erros" class="layer">
      <div class="layer-title">
        <h2>Sistema de Tratamento de Erros</h2>
      </div>
      <div class="folder">
        <h3>1. Erros de Dom√≠nio</h3>
        <div class="implementation">
          <div class="code-title">Defini√ß√£o de Erros Espec√≠ficos</div>
          <div class="code-block">
            <pre>
// src/core/errors/user.errors.ts
export class EmailAlreadyExistsError extends Error {
    constructor(email: string) {
        super(`Email ${email} already exists`);
        this.name = 'EmailAlreadyExistsError';
    }
}

export class UserNotFoundError extends Error {
    constructor(id: string) {
        super(`User with id ${id} not found`);
        this.name = 'UserNotFoundError';
    }
}
                </pre>
          </div>
        </div>
        <div class="implementation">
          <div class="code-title">Filtro Global de Exce√ß√µes</div>
          <div class="code-block">
            <pre>
// src/infrastructure/common/filters/http-exception.filter.ts
@Catch()
export class AllExceptionsFilter implements ExceptionFilter {
    catch(exception: unknown, host: ArgumentsHost) {
        const ctx = host.switchToHttp();
        const response = ctx.getResponse
																	<Response>();

        let status = HttpStatus.INTERNAL_SERVER_ERROR;
        let message = 'Internal server error';

        if (exception instanceof EmailAlreadyExistsError) {
            status = HttpStatus.CONFLICT;
            message = exception.message;
        } else if (exception instanceof UserNotFoundError) {
            status = HttpStatus.NOT_FOUND;
            message = exception.message;
        }

        response.status(status).json({
            statusCode: status,
            message,
            timestamp: new Date().toISOString(),
            path: ctx.getRequest().url,
        });
    }
}
                
																	</pre>
          </div>
        </div>
        <div class="code-explanation">
          <h4>Benef√≠cios:</h4>
          <ul>
            <li>‚úÖ Erros semanticamente significativos</li>
            <li>‚úÖ Tratamento centralizado</li>
            <li>‚úÖ Respostas padronizadas</li>
            <li>‚úÖ Facilidade de manuten√ß√£o</li>
          </ul>
        </div>
      </div>
    </section>


    <!-- Se√ß√£o: Padr√µes de Projeto -->
    <section id="padroes-projeto" class="layer">
      <div class="layer-title">
        <h2>Padr√µes de Projeto e Boas Pr√°ticas</h2>
      </div>
      <div class="folder">
        <h3>1. Repository Pattern</h3>
        <div class="pattern-example">
          <p>Abstrai a camada de persist√™ncia atrav√©s de interfaces.</p>
          <div class="code-title">Exemplo de Uso</div>
          <div class="code-block">
            <pre>
// Interface (Core)
export interface IUserRepository {
    create(user: User): Promise
																		<User>;
    findById(id: string): Promise
																			<User>;
}

// Implementa√ß√£o (Infrastructure)
@Injectable()
export class UserRepository implements IUserRepository {
    constructor(
        @InjectRepository(UserTypeormEntity)
        private readonly userRepository: Repository
																				<UserTypeormEntity>
    ) {}
    // implementa√ß√£o dos m√©todos
}
                
																				</pre>
          </div>
          <div class="code-explanation">
            <h4>Benef√≠cios:</h4>
            <ul>
              <li>‚úÖ Desacoplamento da fonte de dados</li>
              <li>‚úÖ Facilidade para trocar implementa√ß√µes</li>
              <li>‚úÖ Melhor testabilidade</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="folder">
        <h3>2. Mapper Pattern</h3>
        <div class="pattern-example">
          <p>Converte entre entidades de dom√≠nio e entidades de persist√™ncia.</p>
          <div class="code-title">Exemplo de Implementa√ß√£o</div>
          <div class="code-block">
            <pre>
export class UserMapper {
    static toDomain(userEntity: UserTypeormEntity): User {
        return new User(
            userEntity.id,
            userEntity.name,
            userEntity.email,
            userEntity.password
        );
    }

    static toPersistence(user: User): UserTypeormEntity {
        const userEntity = new UserTypeormEntity();
        userEntity.id = user.getId();
        userEntity.name = user.getName();
        userEntity.email = user.getEmail();
        userEntity.password = user.getPassword();
        return userEntity;
    }
}
                </pre>
          </div>
          <div class="code-explanation">
            <h4>Vantagens:</h4>
            <ul>
              <li>‚úÖ Separa√ß√£o clara entre dom√≠nio e persist√™ncia</li>
              <li>‚úÖ Evita vazamento de detalhes de implementa√ß√£o</li>
              <li>‚úÖ Facilita mudan√ßas na estrutura de dados</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="folder">
        <h3>3. Use Case Pattern</h3>
        <div class="pattern-example">
          <p>Encapsula a l√≥gica de neg√≥cio em classes espec√≠ficas.</p>
          <div class="code-title">Exemplo de Caso de Uso</div>
          <div class="code-block">
            <pre>
@Injectable()
export class CreateUserUseCase {
    constructor(
        @Inject('IUserRepository')
        private readonly userRepository: IUserRepository
    ) {}

    async execute(createUserDto: CreateUserDto): Promise
																					<User> {
        // valida√ß√µes e l√≥gica de neg√≥cio
        const user = new User(/*...*/);
        return this.userRepository.create(user);
    }
}
                
																					</pre>
          </div>
          <div class="code-explanation">
            <h4>Vantagens:</h4>
            <ul>
              <li>‚úÖ Separa√ß√£o clara de responsabilidades</li>
              <li>‚úÖ Reutiliza√ß√£o de l√≥gica</li>
              <li>‚úÖ Facilidade de manuten√ß√£o</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="folder">
        <h3>4. DTO Pattern</h3>
        <div class="pattern-example">
          <p>Objetos espec√≠ficos para transfer√™ncia de dados entre camadas.</p>
          <div class="code-title">Exemplo de DTOs</div>
          <div class="code-block">
            <pre>
export class CreateUserDto {
    @IsString()
    @IsNotEmpty()
    name: string;

    @IsEmail()
    email: string;

    @MinLength(6)
    password: string;
}

export class UserResponseDto {
    id: string;
    name: string;
    email: string;

    static fromDomain(user: User): UserResponseDto {
        return {
            id: user.getId(),
            name: user.getName(),
            email: user.getEmail()
        };
    }
}
                </pre>
          </div>
          <div class="code-explanation">
            <h4>Benef√≠cios:</h4>
            <ul>
              <li>‚úÖ Valida√ß√£o de dados de entrada</li>
              <li>‚úÖ Controle de dados expostos</li>
              <li>‚úÖ Documenta√ß√£o clara com Swagger</li>
            </ul>
          </div>
        </div>
      </div>
    </section>


    <!-- Se√ß√£o: Documenta√ß√£o -->
    <section id="documentacao" class="layer">
      <div class="layer-title">
        <h2>Documenta√ß√£o com Swagger</h2>
      </div>
      <div class="implementation">
        <div class="code-title">Configura√ß√£o do Swagger</div>
        <div class="code-block">
          <pre>
const config = new DocumentBuilder()
    .setTitle('Clean Architecture API')
    .setDescription('API com Clean Architecture e NestJS')
    .setVersion('1.0')
    .addTag('users')
    .build();

const document = SwaggerModule.createDocument(app, config);
SwaggerModule.setup('api', app, document);
            </pre>
        </div>
      </div>
      <div class="note">
        <h4>Acesso √† Documenta√ß√£o:</h4>
        <p>A documenta√ß√£o completa da API est√° dispon√≠vel em:</p>
        <code>http://localhost:3000/api</code>
      </div>
    </section>


    <!-- Se√ß√£o: Conclus√£o -->
    <section id="conclusao" class="layer">
      <div class="layer-title">
        <h2>Conclus√£o e Boas Pr√°ticas</h2>
      </div>
      <div class="best-practice">
        <h3>Princ√≠pios Seguidos</h3>
        <ul>
          <li>‚úÖ <strong>Single Responsibility:</strong> Cada classe tem uma √∫nica responsabilidade </li>
          <li>‚úÖ <strong>Open/Closed:</strong> Extens√≠vel sem modificar c√≥digo existente </li>
          <li>‚úÖ <strong>Liskov Substitution:</strong> Implementa√ß√µes podem ser substitu√≠das </li>
          <li>‚úÖ <strong>Interface Segregation:</strong> Interfaces espec√≠ficas para cada cliente </li>
          <li>‚úÖ <strong>Dependency Inversion:</strong> Depend√™ncias apontam para abstra√ß√µes </li>
        </ul>
      </div>
      <div class="warning">
        <h3>Pontos de Aten√ß√£o</h3>
        <ul>
          <li>‚ö†Ô∏è Manter a independ√™ncia das camadas</li>
          <li>‚ö†Ô∏è Evitar vazamento de detalhes de implementa√ß√£o</li>
          <li>‚ö†Ô∏è Tratar erros de forma adequada</li>
          <li>‚ö†Ô∏è Validar dados de entrada</li>
          <li>‚ö†Ô∏è Documentar endpoints e DTOs</li>
        </ul>
      </div>
    </section>
  </body>
</html>